@tailwind base;
@tailwind components;
@tailwind utilities;

@layer utilities {
  .text-balance {
    text-wrap: balance;
  }
}

@layer base {
  /* ---- Dark (default) ---- */
  :root,
  .dark {
    --background: 0 0% 3%;
    --foreground: 0 0% 93%;
    --card: 0 0% 6%;
    --card-foreground: 0 0% 93%;
    --popover: 0 0% 6%;
    --popover-foreground: 0 0% 93%;
    --primary: 0 0% 93%;
    --primary-foreground: 0 0% 3%;
    --secondary: 0 0% 10%;
    --secondary-foreground: 0 0% 93%;
    --muted: 0 0% 12%;
    --muted-foreground: 0 0% 55%;
    --accent: 0 0% 14%;
    --accent-foreground: 0 0% 93%;
    --destructive: 0 0% 30%;
    --destructive-foreground: 0 0% 93%;
    --border: 0 0% 16%;
    --input: 0 0% 16%;
    --ring: 0 0% 93%;
    --radius: 0rem;
    --code-bg: 0 0% 7%;
    --code-header: 0 0% 9%;
    --code-line-hover: 0 0% 10%;
    --code-line-num: 0 0% 28%;
    --code-text: 0 0% 72%;
    --selection-bg: 0 0% 93%;
    --selection-fg: 0 0% 3%;
  }

  /* ---- Light ---- */
  .light {
    --background: 0 0% 99%;
    --foreground: 0 0% 9%;
    --card: 0 0% 96%;
    --card-foreground: 0 0% 9%;
    --popover: 0 0% 99%;
    --popover-foreground: 0 0% 9%;
    --primary: 0 0% 9%;
    --primary-foreground: 0 0% 99%;
    --secondary: 0 0% 93%;
    --secondary-foreground: 0 0% 9%;
    --muted: 0 0% 93%;
    --muted-foreground: 0 0% 42%;
    --accent: 0 0% 93%;
    --accent-foreground: 0 0% 9%;
    --destructive: 0 0% 30%;
    --destructive-foreground: 0 0% 99%;
    --border: 0 0% 88%;
    --input: 0 0% 88%;
    --ring: 0 0% 9%;
    --radius: 0rem;
    --code-bg: 0 0% 96%;
    --code-header: 0 0% 93%;
    --code-line-hover: 0 0% 94%;
    --code-line-num: 0 0% 68%;
    --code-text: 0 0% 30%;
    --selection-bg: 0 0% 9%;
    --selection-fg: 0 0% 99%;
  }

  /* ---- Sepia ---- */
  .sepia {
    --background: 40 30% 95%;
    --foreground: 30 10% 15%;
    --card: 38 25% 91%;
    --card-foreground: 30 10% 15%;
    --popover: 40 30% 95%;
    --popover-foreground: 30 10% 15%;
    --primary: 30 10% 15%;
    --primary-foreground: 40 30% 95%;
    --secondary: 38 20% 87%;
    --secondary-foreground: 30 10% 15%;
    --muted: 38 20% 87%;
    --muted-foreground: 30 8% 45%;
    --accent: 38 20% 87%;
    --accent-foreground: 30 10% 15%;
    --destructive: 0 0% 30%;
    --destructive-foreground: 40 30% 95%;
    --border: 35 18% 82%;
    --input: 35 18% 82%;
    --ring: 30 10% 15%;
    --radius: 0rem;
    --code-bg: 38 22% 90%;
    --code-header: 38 20% 87%;
    --code-line-hover: 38 22% 88%;
    --code-line-num: 30 10% 60%;
    --code-text: 30 8% 35%;
    --selection-bg: 30 10% 15%;
    --selection-fg: 40 30% 95%;
  }
}

@layer base {
  * {
    @apply border-border;
  }
  html {
    scroll-behavior: smooth;
  }
  body {
    @apply bg-background text-foreground;
  }
  ::selection {
    background: hsl(var(--selection-bg));
    color: hsl(var(--selection-fg));
  }
}

@keyframes fade-up {
  from {
    opacity: 0;
    transform: translateY(24px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.animate-fade-up {
  animation: fade-up 0.7s ease-out both;
}

@keyframes line-grow {
  from {
    transform: scaleY(0);
  }
  to {
    transform: scaleY(1);
  }
}

.animate-line-grow {
  animation: line-grow 1s ease-out both;
  transform-origin: top;
}

/* ========================================
   Reading preference defaults (overridden by JS)
   ======================================== */
:root {
  --reading-font-size: 19px;
  --reading-line-height: 1.78;
  --reading-max-width: 768px;
}

/* ========================================
   Notion-style Prose
   ======================================== */

/* Paragraphs */
.notion-prose .notion-p {
  @apply font-serif text-muted-foreground mb-2;
  font-size: var(--reading-font-size);
  line-height: var(--reading-line-height);
  word-spacing: 0.01em;
}

.notion-prose .notion-p + .notion-p {
  @apply mt-0;
}

/* Headings — Plus Jakarta Sans with left accent */
.notion-prose .notion-h1 {
  @apply font-display text-[28px] font-bold text-foreground tracking-tight mt-16 mb-5 leading-tight pl-5;
  border-left: 3px solid hsl(var(--foreground));
}

.notion-prose .notion-h2 {
  @apply font-display text-[22px] font-semibold text-foreground tracking-tight mt-14 mb-4 leading-snug pl-5;
  border-left: 3px solid hsl(var(--muted-foreground) / 0.4);
  padding-top: 1.5rem;
  border-top: 1px solid hsl(var(--border));
}

.notion-prose .notion-h3 {
  @apply font-display text-[18px] font-semibold text-foreground tracking-tight mt-10 mb-3 leading-snug pl-5;
  border-left: 3px solid hsl(var(--muted-foreground) / 0.25);
}

/* Bold / Italic */
.notion-prose strong {
  @apply text-foreground font-semibold;
}

.notion-prose em {
  color: hsl(var(--foreground) / 0.8);
}

/* Inline code — Notion warm tint */
.notion-prose .notion-inline-code {
  @apply font-mono text-[13px] px-1.5 py-[2px] rounded-[3px];
  background: hsl(var(--muted));
  color: hsl(20, 80%, 62%);
}

/* Links */
.notion-prose .notion-link {
  @apply underline underline-offset-2 decoration-muted-foreground/40;
  color: hsl(210, 60%, 65%);
  transition: color 0.15s, text-decoration-color 0.15s;
}

.notion-prose .notion-link:hover {
  color: hsl(210, 70%, 75%);
  text-decoration-color: hsl(210, 70%, 75%);
}

/* ---- Code blocks ---- */
.notion-code-block {
  @apply rounded-lg overflow-hidden my-6;
  background: hsl(var(--code-bg));
  border: 1px solid hsl(var(--border));
}

.notion-code-header {
  @apply flex items-center justify-between px-4 py-2.5;
  background: hsl(var(--code-header));
  border-bottom: 1px solid hsl(var(--border));
}

.notion-code-lang {
  @apply font-mono text-[11px] tracking-wider uppercase;
  color: hsl(var(--muted-foreground));
}

.notion-code-copy {
  @apply flex items-center gap-1.5 font-mono text-[11px] rounded-md px-2.5 py-1 transition-all duration-200;
  color: hsl(var(--muted-foreground));
  background: transparent;
}

.notion-code-copy:hover {
  background: hsl(var(--muted));
  color: hsl(var(--foreground));
}

.notion-code-body {
  @apply overflow-x-auto px-0 py-4;
}

.notion-code-table {
  @apply w-full;
  border-collapse: collapse;
}

.notion-code-row:hover {
  background: hsl(var(--code-line-hover));
}

.notion-code-line-num {
  @apply font-mono text-right select-none px-4;
  font-size: 12px;
  line-height: 1.7;
  color: hsl(var(--code-line-num));
  width: 1%;
  white-space: nowrap;
  user-select: none;
}

.notion-code-line {
  @apply font-mono pl-2 pr-6;
  font-size: 13px;
  line-height: 1.7;
  color: hsl(var(--code-text));
  white-space: pre;
}

/* Syntax highlighting tokens */
.syn-kw {
  color: hsl(280, 55%, 68%);
}

.syn-str {
  color: hsl(130, 45%, 58%);
}

.syn-comment {
  color: hsl(0 0% 38%);
  font-style: italic;
}

.syn-num {
  color: hsl(25, 80%, 62%);
}

.syn-fn {
  color: hsl(210, 65%, 68%);
}

.syn-decorator {
  color: hsl(35, 85%, 62%);
}

/* ---- Lists ---- */
.notion-prose .notion-ul {
  @apply my-2 pl-0;
  list-style: none;
}

.notion-prose .notion-ol {
  @apply my-2 pl-0;
  list-style: none;
  counter-reset: notion-ol;
}

.notion-prose .notion-li {
  @apply font-serif text-muted-foreground py-[3px] pl-7 relative;
  font-size: var(--reading-font-size);
  line-height: var(--reading-line-height);
}

.notion-prose .notion-li::before {
  content: "";
  position: absolute;
  left: 8px;
  top: 14px;
  width: 5px;
  height: 5px;
  border-radius: 50%;
  background: hsl(var(--muted-foreground) / 0.5);
}

.notion-prose .notion-li-ordered {
  @apply font-serif text-muted-foreground py-[3px] pl-8 relative;
  font-size: var(--reading-font-size);
  line-height: var(--reading-line-height);
  counter-increment: notion-ol;
}

.notion-prose .notion-li-ordered::before {
  content: counter(notion-ol) ".";
  position: absolute;
  left: 4px;
  @apply font-mono text-[13px] text-muted-foreground;
}

/* Strong inside list items */
.notion-prose .notion-li strong,
.notion-prose .notion-li-ordered strong {
  @apply text-foreground;
}

/* ---- Blockquote / Callout ---- */
.notion-prose .notion-callout {
  @apply my-6 px-5 py-4 rounded-lg font-serif leading-relaxed;
  font-size: 17px;
  background: hsl(var(--muted) / 0.5);
  border-left: 3px solid hsl(var(--muted-foreground) / 0.3);
  color: hsl(var(--muted-foreground));
}

.notion-prose .notion-callout strong {
  @apply text-foreground;
}

/* ---- Horizontal Rule ---- */
.notion-prose .notion-hr {
  @apply my-10 border-0;
  height: 1px;
  background: hsl(var(--border));
}

/* ---- Tables ---- */
.notion-prose .notion-table-wrap {
  @apply my-6 overflow-x-auto rounded-lg;
  border: 1px solid hsl(var(--border));
}

.notion-prose .notion-table {
  @apply w-full;
  border-collapse: collapse;
}

.notion-prose .notion-th {
  @apply font-mono text-[11px] tracking-wider uppercase text-left px-4 py-3;
  color: hsl(var(--muted-foreground));
  background: hsl(var(--code-bg));
  border-bottom: 1px solid hsl(var(--border));
}

.notion-prose .notion-td {
  @apply text-[14px] px-4 py-3;
  color: hsl(var(--muted-foreground));
  border-bottom: 1px solid hsl(var(--border));
}

.notion-prose .notion-table tr:last-child .notion-td {
  border-bottom: none;
}

.notion-prose .notion-table tr:hover .notion-td {
  background: hsl(var(--code-line-hover));
}

/* ---- Light / Sepia syntax highlighting overrides ---- */
.light .syn-kw {
  color: hsl(280, 65%, 42%);
}
.light .syn-str {
  color: hsl(130, 50%, 32%);
}
.light .syn-comment {
  color: hsl(0 0% 58%);
}
.light .syn-num {
  color: hsl(25, 90%, 42%);
}
.light .syn-fn {
  color: hsl(210, 70%, 42%);
}
.light .syn-decorator {
  color: hsl(35, 90%, 42%);
}
.light .notion-prose .notion-inline-code {
  color: hsl(20, 90%, 42%);
}
.light .notion-prose .notion-link {
  color: hsl(210, 70%, 42%);
}
.light .notion-prose .notion-link:hover {
  color: hsl(210, 80%, 35%);
  text-decoration-color: hsl(210, 80%, 35%);
}

.sepia .syn-kw {
  color: hsl(280, 40%, 45%);
}
.sepia .syn-str {
  color: hsl(130, 35%, 35%);
}
.sepia .syn-comment {
  color: hsl(30 8% 55%);
}
.sepia .syn-num {
  color: hsl(25, 70%, 45%);
}
.sepia .syn-fn {
  color: hsl(210, 50%, 42%);
}
.sepia .syn-decorator {
  color: hsl(35, 70%, 42%);
}
.sepia .notion-prose .notion-inline-code {
  color: hsl(20, 70%, 42%);
}
.sepia .notion-prose .notion-link {
  color: hsl(210, 50%, 40%);
}
.sepia .notion-prose .notion-link:hover {
  color: hsl(210, 60%, 32%);
  text-decoration-color: hsl(210, 60%, 32%);
}

/* ---- Typed callouts ---- */
.notion-callout-typed {
  @apply my-6 px-5 py-4 rounded-lg font-serif flex gap-3.5 items-start;
  font-size: calc(var(--reading-font-size) - 2px);
  line-height: var(--reading-line-height);
}

.notion-callout-typed .callout-icon {
  @apply shrink-0 mt-0.5;
  width: 18px;
  height: 18px;
}

.notion-callout-typed .callout-body {
  @apply flex-1 min-w-0;
}

.notion-callout-typed .callout-label {
  @apply font-display text-[13px] font-semibold tracking-tight mb-1;
}

/* Note */
.callout-note {
  background: hsl(210 50% 50% / 0.08);
  border-left: 3px solid hsl(210, 55%, 55%);
  color: hsl(var(--muted-foreground));
}
.callout-note .callout-icon { color: hsl(210, 55%, 55%); }
.callout-note .callout-label { color: hsl(210, 55%, 60%); }

/* Warning */
.callout-warning {
  background: hsl(45 80% 50% / 0.08);
  border-left: 3px solid hsl(45, 80%, 48%);
  color: hsl(var(--muted-foreground));
}
.callout-warning .callout-icon { color: hsl(45, 80%, 48%); }
.callout-warning .callout-label { color: hsl(45, 80%, 52%); }

/* Mistake / error */
.callout-mistake {
  background: hsl(0 60% 50% / 0.08);
  border-left: 3px solid hsl(0, 55%, 50%);
  color: hsl(var(--muted-foreground));
}
.callout-mistake .callout-icon { color: hsl(0, 55%, 50%); }
.callout-mistake .callout-label { color: hsl(0, 55%, 55%); }

/* Rule of thumb */
.callout-rule {
  background: hsl(150 45% 45% / 0.08);
  border-left: 3px solid hsl(150, 45%, 45%);
  color: hsl(var(--muted-foreground));
}
.callout-rule .callout-icon { color: hsl(150, 45%, 45%); }
.callout-rule .callout-label { color: hsl(150, 45%, 48%); }

/* When to use / tip */
.callout-tip {
  background: hsl(35 75% 50% / 0.08);
  border-left: 3px solid hsl(35, 75%, 48%);
  color: hsl(var(--muted-foreground));
}
.callout-tip .callout-icon { color: hsl(35, 75%, 48%); }
.callout-tip .callout-label { color: hsl(35, 75%, 52%); }
